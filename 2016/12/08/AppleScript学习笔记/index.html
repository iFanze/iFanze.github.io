<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="孟凡泽的博客"><title>AppleScript 学习笔记 | Meng Fanze's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">AppleScript 学习笔记</h1><a id="logo" href="/.">Meng Fanze's Blog</a><p class="description">C++、Web、Game</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/timeline/"><i class="fa fa-book"> 历史</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/guestbook/"><i class="fa fa-comments"> 留言</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">AppleScript 学习笔记</h1><div class="post-meta">Dec 8, 2016<span> | </span><span class="category"><a href="/categories/笔记/">笔记</a></span></div><a class="disqus-comment-count" href="/2016/12/08/AppleScript学习笔记/#vcomment"><span class="valine-comment-count" data-xid="/2016/12/08/AppleScript学习笔记/"></span><span> 条评论</span></a><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-AppleScript入门"><span class="toc-text">1. AppleScript入门</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-快速上手AppleScript编辑器"><span class="toc-text">2. 快速上手AppleScript编辑器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-AppleScript语言初步"><span class="toc-text">3. AppleScript语言初步</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-读懂AppleScript字典"><span class="toc-text">4. 读懂AppleScript字典</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-变量和属性"><span class="toc-text">5. 变量和属性</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-流程控制"><span class="toc-text">6. 流程控制</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#6-1-tell语句"><span class="toc-text">6.1 tell语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-2-if语句"><span class="toc-text">6.2 if语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-3-循环语句"><span class="toc-text">6.3 循环语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#6-4文本比较"><span class="toc-text">6.4文本比较</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-基本用户交互"><span class="toc-text">7. 基本用户交互</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#7-1-对话框和输入框"><span class="toc-text">7.1 对话框和输入框</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-2-警告框"><span class="toc-text">7.2 警告框</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-3-选择框"><span class="toc-text">7.3 选择框</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-4-文件选择框"><span class="toc-text">7.4 文件选择框</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#7-5-其它用户交互"><span class="toc-text">7.5 其它用户交互</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-错误处理"><span class="toc-text">8. 错误处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#8-1-try语句"><span class="toc-text">8.1 try语句</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-2-抛出错误"><span class="toc-text">8.2 抛出错误</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#8-3-超时"><span class="toc-text">8.3 超时</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-文件操作"><span class="toc-text">9. 文件操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#9-1-Alias类型"><span class="toc-text">9.1 Alias类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-2-相对路径和POSIX路径"><span class="toc-text">9.2 相对路径和POSIX路径</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-3-文件读取"><span class="toc-text">9.3 文件读取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#9-4-文件写入"><span class="toc-text">9.4 文件写入</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-事件处理器"><span class="toc-text">10. 事件处理器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#10-1-基本的事件处理器"><span class="toc-text">10.1 基本的事件处理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-2-带参数的事件处理器"><span class="toc-text">10.2 带参数的事件处理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-3-返回值"><span class="toc-text">10.3 返回值</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-4-run和open事件处理器"><span class="toc-text">10.4 run和open事件处理器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-5-保持打开的脚本应用程序"><span class="toc-text">10.5 保持打开的脚本应用程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#10-6-文件夹操作"><span class="toc-text">10.6 文件夹操作</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-脚本对象"><span class="toc-text">11. 脚本对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#11-1-me关键字"><span class="toc-text">11.1 me关键字</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-2-编写和使用基本的Script对象"><span class="toc-text">11.2 编写和使用基本的Script对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-3-载入和调用外部script对象"><span class="toc-text">11.3 载入和调用外部script对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#11-4-修改外部script对象中的属性"><span class="toc-text">11.4 修改外部script对象中的属性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#附录"><span class="toc-text">附录</span></a></li></ol></div></div><div class="post-content"><p>“AppleScript简明基础教程”的阅读笔记。</p>
<a id="more"></a>
<!-- toc -->
<h2 id="1-AppleScript入门"><a href="#1-AppleScript入门" class="headerlink" title="1. AppleScript入门"></a>1. AppleScript入门</h2><p>工作机制：</p>
<p><img src="http://static.ifanze.cn/14812008690466.jpg" alt=""></p>
<h2 id="2-快速上手AppleScript编辑器"><a href="#2-快速上手AppleScript编辑器" class="headerlink" title="2. 快速上手AppleScript编辑器"></a>2. 快速上手AppleScript编辑器</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;Finder&quot;</span><br><span class="line">    make new folder at desktop</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<p>脚本的四种存储格式：</p>
<ol>
<li><code>.scpt</code>，脚本格式，可以设置是否能编辑。</li>
<li><code>.scptd</code>，脚本包格式，包含rtfd介绍文件、plist配置文件、sctp脚本。</li>
<li><code>.app</code>，应用程序格式，具有标准Cocoa程序的结构，有“仅运行”、“启动屏幕”、”保持打开“三个选项。</li>
<li><code>.applescript</code>，文本格式。</li>
</ol>
<p>应用程序对AppleScript的支持类型：</p>
<ol>
<li>可编程。</li>
<li>可录制。</li>
<li>可嵌入。</li>
</ol>
<p>实例：建立100个文件夹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;Finder&quot; </span><br><span class="line">    make new folder at desktop with properties &#123;name:&quot;Test&quot;&#125; </span><br><span class="line">    repeat with a from 1 to 100</span><br><span class="line">        make new folder at folder &quot;Test&quot; of desktop with properties &#123;name:a as string&#125; </span><br><span class="line">    end repeat </span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<h2 id="3-AppleScript语言初步"><a href="#3-AppleScript语言初步" class="headerlink" title="3. AppleScript语言初步"></a>3. AppleScript语言初步</h2><p>AppleSript是面向对象的脚本语言，有对象、属性、命令的概念，类似类、属性、方法的概念。</p>
<p>采用Unicode文字编码，不区分大小写。</p>
<p>标识符：必须以英文开头，可使用字母、数字、下划线。但可以在开头和结尾使用<code>|</code>，这样就能使用全部Unicode字符了（除去<code>|</code>）。</p>
<p>数据类型：</p>
<ol>
<li><code>Boolean</code>：仅包括<code>True</code>和<code>False</code>。</li>
<li><code>Number</code>、<code>Integer</code>、<code>Real</code>。</li>
<li><code>Text</code>、<code>String</code>：无区别。</li>
<li><code>Date</code>：取决于系统设置。</li>
<li><code>Constant</code>：系统定义的yes、no、ask等，也可以是用户定义的常量，关键字也可以认作是常量。</li>
<li><code>List</code>：<code>{1,2,3}</code>、<code>{1,1.9,&quot;text&quot;}</code>，可嵌套。</li>
<li><code>Record</code>：<code>{first:&quot;111&quot;,last:&quot;222&quot;}</code>，带有名称的列表。可以使用<code>of</code>进行访问：</li>
</ol>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">first of &#123;first:&quot;111&quot;,last:&quot;222&quot;&#125;</span><br></pre></td></tr></table></figure>
<p>确定数据类型：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">class of &quot;string&quot;</span><br></pre></td></tr></table></figure>
<p>强制类型转换：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&quot;1.99&quot; as real</span><br><span class="line">&quot;1.99&quot; as integer   --得到2</span><br><span class="line">&quot;text&quot; as list      --得到&#123;&quot;text&quot;&#125;</span><br><span class="line">&#123;a:1,b:2&#125; as list   --得到&#123;1,2&#125;</span><br><span class="line">&#123;1,2&#125; as record     --错误，无法得到标识符。</span><br></pre></td></tr></table></figure>
<p>数学运算符（注意3/2的值为1.5）：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">+ - * /或÷ ^ div mod</span><br></pre></td></tr></table></figure>
<p>比较运算符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">= &gt; &gt;= &lt; &lt;= </span><br><span class="line"></span><br><span class="line">start[s] with</span><br><span class="line">end[s] with</span><br><span class="line"></span><br><span class="line">contain[s]</span><br><span class="line">dosen&apos;t contain</span><br><span class="line"></span><br><span class="line">is in</span><br><span class="line">is not in</span><br></pre></td></tr></table></figure>
<p>逻辑运算符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">and or not</span><br></pre></td></tr></table></figure>
<p>合并运算符<code>&amp;</code>：</p>
<ul>
<li>左边Text，结果为Text，存在报错可能。</li>
<li>左边Record，结果为Record，存在报错可能。</li>
<li>左边为其它类型，结果为List。</li>
</ul>
<p><img src="http://static.ifanze.cn/14812069593782.jpg" alt=""></p>
<p>提取对象中的元素：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">characters of &quot;A string&quot;        --得到&#123;&quot;A&quot;,&quot; &quot;,....&#125;</span><br><span class="line">every character of &quot;A string&quot;</span><br><span class="line"></span><br><span class="line">words of &quot;a string&quot;</span><br><span class="line"></span><br><span class="line">--进阶的（words类似）：</span><br><span class="line">characters 3 through 5 of &quot;a string&quot;    --得到&#123;&quot;s&quot;,&quot;t&quot;,&quot;r&quot;&#125;</span><br><span class="line">characters 3 thru 5 of &quot;a string&quot;</span><br><span class="line">character 3 of &quot;a string&quot;               --得到&quot;s&quot;</span><br></pre></td></tr></table></figure>
<p>提取文件列表：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">tell application &quot;Finder&quot;</span><br><span class="line">    files of desktop</span><br><span class="line">    folders of desktop</span><br><span class="line">    </span><br><span class="line">    name of files of desktop</span><br><span class="line">    </span><br><span class="line">    files of desktop whose name begins with &quot;a&quot;</span><br></pre></td></tr></table></figure>
<ul>
<li>复数可改成<code>every</code>。</li>
<li><code>whose</code>可改成<code>where its</code></li>
</ul>
<p>注释：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">-- 行尾注释</span><br><span class="line">#  行尾注释（2.0）</span><br><span class="line">(*</span><br><span class="line">    块注释</span><br><span class="line">*)</span><br></pre></td></tr></table></figure>
<p>代码缩写：</p>
<ul>
<li><code>application</code>：<code>app</code></li>
<li><code>end tell/repeat/try</code>：<code>end</code></li>
<li><code>through</code>：<code>thru</code></li>
</ul>
<h2 id="4-读懂AppleScript字典"><a href="#4-读懂AppleScript字典" class="headerlink" title="4. 读懂AppleScript字典"></a>4. 读懂AppleScript字典</h2><p>S：Suite 套装<br>C（圆）：Command 命令<br>C（方）：Class 类<br>P：Property 属性</p>
<h2 id="5-变量和属性"><a href="#5-变量和属性" class="headerlink" title="5. 变量和属性"></a>5. 变量和属性</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set name to value as type</span><br><span class="line">set myRes to the result of (make new folder at desktop)</span><br></pre></td></tr></table></figure>
<p>可分为全局变量和局部变量。显式声明可以在变量名前加上<code>Global</code>和<code>Local</code>。</p>
<p>Record和List是传引用的，其它类型是传值得。这两种类型传值要使用：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">set a to &#123;1,2,3&#125;</span><br><span class="line">set b to 1</span><br><span class="line">copy a to b</span><br></pre></td></tr></table></figure>
<p>定义属性：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">property countTimes : 0</span><br></pre></td></tr></table></figure>
<p>脚本退出后其值依然不变，一定是全局的。</p>
<p>常用的预定义变量有：</p>
<ul>
<li><code>result</code>：记录最近一个命令执行的结果，如果没有会报错</li>
<li><code>it</code>：指代最近的一个tell对象</li>
<li><code>me</code>：指代脚本，如path to me</li>
<li><code>tab</code>：用于string，一个制表符</li>
<li><code>return</code>：用于string，一个换行</li>
</ul>
<h2 id="6-流程控制"><a href="#6-流程控制" class="headerlink" title="6. 流程控制"></a>6. 流程控制</h2><h3 id="6-1-tell语句"><a href="#6-1-tell语句" class="headerlink" title="6.1 tell语句"></a>6.1 tell语句</h3><p>有简单形式和复合形式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">tell front window of application &quot;Finder&quot; to close</span><br><span class="line">tell application &quot;Finder&quot;</span><br><span class="line">    close front window</span><br><span class="line">end tell</span><br></pre></td></tr></table></figure>
<h3 id="6-2-if语句"><a href="#6-2-if语句" class="headerlink" title="6.2 if语句"></a>6.2 if语句</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">if boolean then statement</span><br><span class="line">if boolean1 then</span><br><span class="line">    statement1</span><br><span class="line">else if boolean2 then</span><br><span class="line">    statement2</span><br><span class="line">else </span><br><span class="line">    statement3</span><br><span class="line">end if</span><br></pre></td></tr></table></figure>
<h3 id="6-3-循环语句"><a href="#6-3-循环语句" class="headerlink" title="6.3 循环语句"></a>6.3 循环语句</h3><p>退出循环使用<code>exit</code>。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">repeat</span><br><span class="line">    ...</span><br><span class="line">end repeat</span><br><span class="line"></span><br><span class="line">repeat n times</span><br><span class="line">    ...</span><br><span class="line">end repeat</span><br><span class="line"></span><br><span class="line">repeat until boolean</span><br><span class="line">    ...</span><br><span class="line">end repeat</span><br><span class="line"></span><br><span class="line">repeat while boolean</span><br><span class="line">    ...</span><br><span class="line">end repeat</span><br><span class="line"></span><br><span class="line">repeat with loopVariable from startValue to stopValue by stepValue</span><br><span class="line">    ...</span><br><span class="line">end repeat</span><br><span class="line"></span><br><span class="line">repeat with loopVariable in list</span><br><span class="line">    ... --得到的是位置，获取内容要使用contents of loopVariable</span><br><span class="line">end repeat</span><br></pre></td></tr></table></figure>
<h3 id="6-4文本比较"><a href="#6-4文本比较" class="headerlink" title="6.4文本比较"></a>6.4文本比较</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">considering attribute1 but ignoring attribute2</span><br><span class="line">    --compare texts</span><br><span class="line">end considering</span><br></pre></td></tr></table></figure>
<p>包括：</p>
<ul>
<li><code>case</code></li>
<li><code>diacriticals</code>：字母变调符号</li>
<li><code>hyphens</code>：连字符</li>
<li><code>numeric strings</code>：如启用它来比较版本号，”1.10.1” &gt; “1.9.4”</li>
<li><code>punctuation</code>：标点符号</li>
<li><code>white space</code></li>
</ul>
<h2 id="7-基本用户交互"><a href="#7-基本用户交互" class="headerlink" title="7. 基本用户交互"></a>7. 基本用户交互</h2><h3 id="7-1-对话框和输入框"><a href="#7-1-对话框和输入框" class="headerlink" title="7.1 对话框和输入框"></a>7.1 对话框和输入框</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">display dialog &quot;text&quot;   --包含确认和取消</span><br><span class="line">display dialog &quot;text&quot; buttons &#123;&quot;好的&quot;,&quot;明白&quot;&#125; default button &quot;好的&quot; with title &quot;标题&quot; with icon note giving up after 5  --5秒后自动消失</span><br><span class="line"></span><br><span class="line">display dialog &quot;text&quot; default answer &quot;默认输入&quot;</span><br><span class="line">display dialog &quot;text&quot; default answer &quot;默认输入&quot; hidden answer true --输入密码</span><br></pre></td></tr></table></figure>
<p>返回值：是一个Record</p>
<ul>
<li><code>text returned</code>：用户输入的文本</li>
<li><code>button returned</code>：按钮</li>
<li><code>gave up</code>：是否自动超时消失</li>
</ul>
<h3 id="7-2-警告框"><a href="#7-2-警告框" class="headerlink" title="7.2 警告框"></a>7.2 警告框</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">display alert &quot;text&quot; message &quot;detail&quot; as warning</span><br></pre></td></tr></table></figure>
<p>还可以是<code>critical</code>或<code>infomation</code>，也可以使用<code>buttons</code>、<code>give up after</code>。</p>
<h3 id="7-3-选择框"><a href="#7-3-选择框" class="headerlink" title="7.3 选择框"></a>7.3 选择框</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">choose from list &#123;&quot;choice1&quot;,&quot;choice2&quot;&#125; with title &quot;title&quot; with prompt &quot;xxxx&quot; default items &#123;&quot;choice2&quot;&#125; with empty selection allowed and multiple selections allowed</span><br></pre></td></tr></table></figure>
<h3 id="7-4-文件选择框"><a href="#7-4-文件选择框" class="headerlink" title="7.4 文件选择框"></a>7.4 文件选择框</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">--选文件名称：</span><br><span class="line">choose file name with prompt &quot;xxx&quot; default name &quot;xxx&quot; default location file &quot;Macintosh HD:Users&quot;</span><br><span class="line"></span><br><span class="line">--选文件夹，返回alias或者List：</span><br><span class="line">choose folder with prompt &quot;xxx&quot; default location file &quot;Macintosh HD:Users&quot; with invisibles, multiple selection allowed and showing package contents</span><br><span class="line"></span><br><span class="line">--选文件，可以用的参数同选文件夹：</span><br><span class="line">choose file of type &#123;&quot;txt&quot;&#125;</span><br></pre></td></tr></table></figure>
<h3 id="7-5-其它用户交互"><a href="#7-5-其它用户交互" class="headerlink" title="7.5 其它用户交互"></a>7.5 其它用户交互</h3><p><code>choose color</code>、<code>beep n</code>、<code>delay n</code>、<code>say text</code>。</p>
<h2 id="8-错误处理"><a href="#8-错误处理" class="headerlink" title="8. 错误处理"></a>8. 错误处理</h2><h3 id="8-1-try语句"><a href="#8-1-try语句" class="headerlink" title="8.1 try语句"></a>8.1 try语句</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">try</span><br><span class="line">    ...</span><br><span class="line">end try</span><br><span class="line"></span><br><span class="line">try </span><br><span class="line">    ...</span><br><span class="line">on error errText number errNum</span><br><span class="line">    ...</span><br><span class="line">end try</span><br></pre></td></tr></table></figure>
<h3 id="8-2-抛出错误"><a href="#8-2-抛出错误" class="headerlink" title="8.2 抛出错误"></a>8.2 抛出错误</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">error &quot;自定义错误&quot; number 999</span><br></pre></td></tr></table></figure>
<h3 id="8-3-超时"><a href="#8-3-超时" class="headerlink" title="8.3 超时"></a>8.3 超时</h3><p>默认120秒等待用户或应用程序响应，否则抛出”AppleEvent已超时”，number-1712。如果需要自己确定一个时间：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">with timeout of x seconds</span><br><span class="line">    ...</span><br><span class="line">end timeout</span><br></pre></td></tr></table></figure>
<h2 id="9-文件操作"><a href="#9-文件操作" class="headerlink" title="9. 文件操作"></a>9. 文件操作</h2><h3 id="9-1-Alias类型"><a href="#9-1-Alias类型" class="headerlink" title="9.1 Alias类型"></a>9.1 Alias类型</h3><p>一个文件指针，记录文件的唯一识别码，即使文件被移动也能找到。</p>
<p>也可以使用传统的file类型，但我们一般总是使用alias，file多用于操作尚不存在的文件。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set myAlias1 to alias &quot;Macintosh HD:System:Library:&quot;</span><br><span class="line">set myAlias2 to alias &quot;Macintosh HD:Users:xxx:Desktop:a.txt&quot;</span><br></pre></td></tr></table></figure>
<h3 id="9-2-相对路径和POSIX路径"><a href="#9-2-相对路径和POSIX路径" class="headerlink" title="9.2 相对路径和POSIX路径"></a>9.2 相对路径和POSIX路径</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">path to documents folder</span><br><span class="line">path to library folder from system domain</span><br></pre></td></tr></table></figure>
<p>还可以获得application support、applications folder、desktop、document folder、downloads folder、system folder等，域还包括user domain（缺省值）、system domain和local domain。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POSIX path of alias &quot;Macintosh HD:System&quot; --返回/System/</span><br><span class="line">POSIX file &quot;Macintosh HD:Users:a.txt&quot; --返回/Users/a.txt</span><br></pre></td></tr></table></figure>
<p>还是推荐使用alias，不要与POSIX file混用。</p>
<h3 id="9-3-文件读取"><a href="#9-3-文件读取" class="headerlink" title="9.3 文件读取"></a>9.3 文件读取</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">set myFile to alias &quot;Macintosh HD:a.txt&quot;</span><br><span class="line">read myFile</span><br></pre></td></tr></table></figure>
<ul>
<li><code>from n</code>：从哪个字节处开始读取</li>
<li><code>for n</code>：读取多少字节</li>
<li><code>to n</code>：读取到哪里</li>
<li><code>before 文本</code>：读取到指定文本（不含本身）</li>
<li><code>until 文本</code>：读取到指定文本（包含本身）</li>
<li><code>using delimiter 文本</code>：指定分隔符，读取成list类型数据，这里的文本参数也可以是list。</li>
<li><code>as 类型</code>：读取成何种类型，如text，list。</li>
</ul>
<p>读到文件结尾会抛出错误，因此要先确定文件长度，使用<code>get eof</code>命令。</p>
<h3 id="9-4-文件写入"><a href="#9-4-文件写入" class="headerlink" title="9.4 文件写入"></a>9.4 文件写入</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">set aFile to alias &quot;...a.txt&quot;</span><br><span class="line">set fp to open for access aFile with write permission</span><br><span class="line">write &quot;abc&quot; to fp</span><br><span class="line">close access to fp</span><br></pre></td></tr></table></figure>
<p><code>write</code>命令可以指定<code>starting at</code>参数指定开始写入的位置。</p>
<p>任何文件操作，包括读取和写入，都要注意打开和关闭文件。</p>
<h2 id="10-事件处理器"><a href="#10-事件处理器" class="headerlink" title="10. 事件处理器"></a>10. 事件处理器</h2><p>类似函数。</p>
<h3 id="10-1-基本的事件处理器"><a href="#10-1-基本的事件处理器" class="headerlink" title="10.1 基本的事件处理器"></a>10.1 基本的事件处理器</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">on Helloworld()</span><br><span class="line">    display dialog &quot;Hello,world&quot;</span><br><span class="line">end Helloworld</span><br><span class="line"></span><br><span class="line">Hellowworld()</span><br></pre></td></tr></table></figure>
<p>注意，无法再Tell语句块内直接调用，如果确实要调用，使用<code>Helloworld() of me</code>。</p>
<h3 id="10-2-带参数的事件处理器"><a href="#10-2-带参数的事件处理器" class="headerlink" title="10.2 带参数的事件处理器"></a>10.2 带参数的事件处理器</h3><p>包括位置参数和标签参数。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">on Hello(somebody, howlong)</span><br><span class="line">    display dialog somebody giving up after howlong</span><br><span class="line">end Hello</span><br><span class="line"></span><br><span class="line">Hello(&quot;Apple&quot;,2)</span><br><span class="line"></span><br><span class="line">on Hello to somebody for howlong</span><br><span class="line">    ...</span><br><span class="line">end Hello</span><br><span class="line"></span><br><span class="line">Hello to &quot;Apple&quot; for 2</span><br></pre></td></tr></table></figure>
<p>一般使用有意义的介词，但还是用位置参数比较好吧……</p>
<h3 id="10-3-返回值"><a href="#10-3-返回值" class="headerlink" title="10.3 返回值"></a>10.3 返回值</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">on add(x,y)</span><br><span class="line">    set answer to (x+y)</span><br><span class="line">    return answer</span><br><span class="line">end add</span><br><span class="line"></span><br><span class="line">display dialog add(1,2)</span><br></pre></td></tr></table></figure>
<h3 id="10-4-run和open事件处理器"><a href="#10-4-run和open事件处理器" class="headerlink" title="10.4 run和open事件处理器"></a>10.4 run和open事件处理器</h3><p>只用于脚本应用程序。</p>
<p><code>run</code>提供程序入口，如果显式声明的话不能有任何代码在事件处理器外。</p>
<p><code>open</code>用于实现拖拽功能。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">on open names</span><br><span class="line">    set pathNames to &quot;&quot;</span><br><span class="line">    repeat with i in names</span><br><span class="line">        set iPath to (i as text)</span><br><span class="line">        set pathNames to pathNames &amp; iPath &amp; return</span><br><span class="line">    end repeat</span><br><span class="line">    </span><br><span class="line">    tell application &quot;TextEdit&quot;</span><br><span class="line">        set paragraph 1 of front document to pathNames</span><br><span class="line">    end tell</span><br><span class="line">    </span><br><span class="line">    return</span><br><span class="line">end open</span><br></pre></td></tr></table></figure>
<h3 id="10-5-保持打开的脚本应用程序"><a href="#10-5-保持打开的脚本应用程序" class="headerlink" title="10.5 保持打开的脚本应用程序"></a>10.5 保持打开的脚本应用程序</h3><p>将脚本存储为应用程序，并勾选“保持打开”。</p>
<p><code>idle</code>事件处理器：处理应用程序空闲时的后台任务，只要不退出或者有其他任务，他隔一段时间（默认30s，可以通过<code>return n</code>控制）会执行一次。</p>
<p><code>quit</code>事件处理器：用于处理用户手动退出保持运行的程序时要执行的任务。其中必须包含有<code>continue quit</code>命令，否则程序将不可能正常退出。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">on idle</span><br><span class="line">    beep 2</span><br><span class="line">    display dialog &quot;程序正在运行&quot; giving up after 1</span><br><span class="line">    return 5</span><br><span class="line">end idle</span><br><span class="line"></span><br><span class="line">on quit</span><br><span class="line">    display dialog &quot;真的要退出&quot; buttons&#123;&quot;是&quot;,&quot;否&quot;&#125;</span><br><span class="line">    if button returned of result = &quot;是的&quot; then</span><br><span class="line">        continue quit</span><br><span class="line">    end if</span><br><span class="line">end quit</span><br></pre></td></tr></table></figure>
<h3 id="10-6-文件夹操作"><a href="#10-6-文件夹操作" class="headerlink" title="10.6 文件夹操作"></a>10.6 文件夹操作</h3><p>存储在”资源库/Scripts/Folder Action Scripts“，或者用户资源库下的。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">on adding folder items to theFolder after receiving theItemList</span><br><span class="line">    display dialog((count theItemList) &amp; &quot;个项目被添加&quot;) as text buttons&#123;&quot;好&quot;,&quot;立即查看&quot;&#125;</span><br><span class="line">    if button returned of result = &quot;立即查看&quot; then</span><br><span class="line">        tell application &quot;Finder&quot;</span><br><span class="line">            open theFolder</span><br><span class="line">        end tell</span><br><span class="line">    end if</span><br><span class="line">end adding folder items to</span><br></pre></td></tr></table></figure>
<p>文件夹操作的缺点是运行速度慢，好处是不影响系统使用。</p>
<h2 id="11-脚本对象"><a href="#11-脚本对象" class="headerlink" title="11. 脚本对象"></a>11. 脚本对象</h2><h3 id="11-1-me关键字"><a href="#11-1-me关键字" class="headerlink" title="11.1 me关键字"></a>11.1 me关键字</h3><p>指代脚本，两个常见用途：</p>
<ul>
<li><code>path to me</code>，返回脚本路径或是AppleScript编辑器路径</li>
<li><code>class of me</code>，得到script。</li>
</ul>
<h3 id="11-2-编写和使用基本的Script对象"><a href="#11-2-编写和使用基本的Script对象" class="headerlink" title="11.2 编写和使用基本的Script对象"></a>11.2 编写和使用基本的Script对象</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">property dialogText : &quot;xxx&quot;</span><br><span class="line">script ShowMe</span><br><span class="line">    display dialog dialogText</span><br><span class="line">    </span><br><span class="line">    on showSomething()</span><br><span class="line">        display dialog &quot;yyyy&quot;</span><br><span class="line">    end</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">run ShowMe</span><br><span class="line">showSomething() of ShowMe</span><br><span class="line"></span><br><span class="line">--另一种更推荐的方式：</span><br><span class="line">tell ShowMe</span><br><span class="line">    run</span><br><span class="line">    showSomething()</span><br><span class="line">end</span><br></pre></td></tr></table></figure>
<h3 id="11-3-载入和调用外部script对象"><a href="#11-3-载入和调用外部script对象" class="headerlink" title="11.3 载入和调用外部script对象"></a>11.3 载入和调用外部script对象</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">set thePath to ((path to desktop) as text) &amp; &quot;Script to Load.scpt&quot;</span><br><span class="line"></span><br><span class="line">set theScript to load script file thePath</span><br><span class="line"></span><br><span class="line">run ShowMe of theScript</span><br><span class="line">showSomething() of ShowMe of theScript</span><br></pre></td></tr></table></figure>
<h3 id="11-4-修改外部script对象中的属性"><a href="#11-4-修改外部script对象中的属性" class="headerlink" title="11.4 修改外部script对象中的属性"></a>11.4 修改外部script对象中的属性</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">set thePath to ((path to desktop) as text) &amp; &quot;Script to Load.scpt&quot;</span><br><span class="line">set theScript to load script file thePath</span><br><span class="line"></span><br><span class="line">run ShowMe of theScript</span><br><span class="line"></span><br><span class="line">set dialogText of theScript to &quot;zzzzz&quot;</span><br><span class="line"></span><br><span class="line">run ShowMe of theScipt</span><br><span class="line"></span><br><span class="line">--如果是要修改脚本文件中的属性(比较危险)：</span><br><span class="line">store script theScript in file thePath with replacing</span><br></pre></td></tr></table></figure>
<h2 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h2><p><img src="http://static.ifanze.cn/14812140639900.jpg" alt=""><br><img src="http://static.ifanze.cn/14812141121492.jpg" alt=""></p>
</div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>Meng Fanze</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="/2016/12/08/AppleScript学习笔记/">http://ifanze.cn/2016/12/08/AppleScript学习笔记/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>转载请在评论区说明。</li></ul></div><br><div class="tags"><a href="/tags/macOS/">macOS</a></div><div class="post-nav"><a class="pre" href="/2017/04/09/《C++ Primer》(1)/">《C++ Primer》读书笔记 1</a><a class="next" href="/2016/05/09/Python学习笔记/">Python 学习笔记</a></div><div id="vcomment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var notify = 'true' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'kfIuT7r4gG6hnmNl3uQ5vOqp-gzGzoHsz',
  appKey:'59tx3uBM3K1Ao4JFH5oE3VEK',
  placeholder:'Welcome~',
  avatar:'retro',
  guest_info:guest_info,
  pageSize:'10'
})</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://ifanze.cn"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/《C-Primer》/">《C++ Primer》</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/《代码大全2》/">《代码大全2》</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/《深入理解计算机系统》/">《深入理解计算机系统》</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/笔记/">笔记</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/coding/" style="font-size: 15px;">coding</a> <a href="/tags/C/" style="font-size: 15px;">C++</a> <a href="/tags/macOS/" style="font-size: 15px;">macOS</a> <a href="/tags/参考/" style="font-size: 15px;">参考</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/读书/" style="font-size: 15px;">读书</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/libevent/" style="font-size: 15px;">libevent</a> <a href="/tags/python/" style="font-size: 15px;">python</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://ifanze.cn" title="欢迎友链～" target="_blank">欢迎友链～</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">Meng Fanze's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script><script type="text/javascript" src="/js/fanze.js?v=0.0.0"></script></div></body></html>