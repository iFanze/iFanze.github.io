<!DOCTYPE html><html lang="zh-CN"><head><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description" content="孟凡泽的博客"><title>《C++ Primer》读书笔记 4 | Meng Fanze's Blog</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/normalize/8.0.0/normalize.min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//cdn.bootcss.com/jquery/3.3.1/jquery.min.js"></script><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"><link rel="alternate" type="application/atom+xml" href="/atom.xml"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">《C++ Primer》读书笔记 4</h1><a id="logo" href="/.">Meng Fanze's Blog</a><p class="description">C++、Web、Game</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/timeline/"><i class="fa fa-book"> 历史</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a><a href="/guestbook/"><i class="fa fa-comments"> 留言</i></a><a href="/atom.xml"><i class="fa fa-rss"> 订阅</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">《C++ Primer》读书笔记 4</h1><div class="post-meta">Jul 24, 2017<span> | </span><span class="category"><a href="/categories/《C-Primer》/">《C++ Primer》</a></span></div><a class="disqus-comment-count" href="/2017/07/24/《C++ Primer》读书笔记 (4)/#vcomment"><span class="valine-comment-count" data-xid="/2017/07/24/《C++ Primer》读书笔记 (4)/"></span><span> 条评论</span></a><div class="clear"><div class="toc-article" id="toc"><div class="toc-title">文章目录</div><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#第四章-表达式"><span class="toc-text">第四章 表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#4-1-基础"><span class="toc-text">4.1 基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-1-基本概念"><span class="toc-text">4.1.1 基本概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-2-优先级与结合律"><span class="toc-text">4.1.2 优先级与结合律</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-3-求值顺序"><span class="toc-text">4.1.3 求值顺序</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-2-算术运算符"><span class="toc-text">4.2 算术运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-3-逻辑与关系运算符"><span class="toc-text">4.3 逻辑与关系运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-4-赋值运算符"><span class="toc-text">4.4 赋值运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-5-递增和递减运算符"><span class="toc-text">4.5 递增和递减运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-6-成员访问运算符"><span class="toc-text">4.6 成员访问运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-7-条件运算符"><span class="toc-text">4.7 条件运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-8-位运算符"><span class="toc-text">4.8 位运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-9-sizeof运算符"><span class="toc-text">4.9 sizeof运算符</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-10-逗号表达式"><span class="toc-text">4.10 逗号表达式</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-11-类型转换"><span class="toc-text">4.11 类型转换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-11-1-算术转换"><span class="toc-text">4.11.1 算术转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-11-2-其它隐式类型转换"><span class="toc-text">4.11.2 其它隐式类型转换</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-11-3-显式转换"><span class="toc-text">4.11.3 显式转换</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-12-运算符优先级表"><span class="toc-text">4.12 运算符优先级表</span></a></li></ol></li></ol></div></div><div class="post-content"><p>《C++ Primer》读书笔记 第四章 表达式</p>
<a id="more"></a>
<!-- toc -->
<h1 id="第四章-表达式"><a href="#第四章-表达式" class="headerlink" title="第四章 表达式"></a>第四章 表达式</h1><h2 id="4-1-基础"><a href="#4-1-基础" class="headerlink" title="4.1 基础"></a>4.1 基础</h2><h3 id="4-1-1-基本概念"><a href="#4-1-1-基本概念" class="headerlink" title="4.1.1 基本概念"></a>4.1.1 基本概念</h3><ul>
<li>一元运算符、二元运算符。</li>
<li>组合运算符、运算对象：注意优先级、结合律、求值顺序。</li>
<li>运算对象转换。</li>
<li>重载运算符。</li>
<li>左值：求值结果是一个对象或函数，但以常量对象为代表的某些左值实际上不能放在赋值语句左侧。</li>
<li>需要右值的地方可以用左值替代，反之则不行。</li>
</ul>
<h3 id="4-1-2-优先级与结合律"><a href="#4-1-2-优先级与结合律" class="headerlink" title="4.1.2 优先级与结合律"></a>4.1.2 优先级与结合律</h3><ul>
<li>优先级：相对不同运算符而言。</li>
<li>结合律：相对相同运算符而言。</li>
<li>规定了运算对象的组合方式。</li>
</ul>
<h3 id="4-1-3-求值顺序"><a href="#4-1-3-求值顺序" class="headerlink" title="4.1.3 求值顺序"></a>4.1.3 求值顺序</h3><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = f1() * f2();</span><br></pre></td></tr></table></figure>
<ul>
<li>我们只知道函数在乘法运算之前调用，但不知道谁先调用。</li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line"><span class="built_in">cout</span> &lt;&lt; ++i &lt;&lt; <span class="built_in">endl</span>;</span><br></pre></td></tr></table></figure>
<ul>
<li>对没有指定求值顺序的运算符来说，如果表达式指向并修改了对象，它的结果是未定义的。</li>
<li>4种明确规定了求值顺序的运算：<code>&amp;&amp;</code>、<code>||</code>、<code>?:</code>、<code>,</code>。</li>
</ul>
<h2 id="4-2-算术运算符"><a href="#4-2-算术运算符" class="headerlink" title="4.2 算术运算符"></a>4.2 算术运算符</h2><p><img src="http://static.ifanze.cn/2018-06-23-14919819824567.jpg" alt=""></p>
<ul>
<li>C++11规定商值一律向0取整（即直接去掉小数部分）。即<code>(-m)/n</code>、<code>m/(-n)</code>都等于<code>-(m/n)</code>。</li>
<li>C++11规定取余的符号与被除数一样：<code>m%(-n)</code>等于<code>m%n</code>，<code>(-m)%n</code>等于<code>-(m%n)</code>。</li>
</ul>
<h2 id="4-3-逻辑与关系运算符"><a href="#4-3-逻辑与关系运算符" class="headerlink" title="4.3 逻辑与关系运算符"></a>4.3 逻辑与关系运算符</h2><p><img src="http://static.ifanze.cn/2018-06-23-14919824475818.jpg" alt=""></p>
<ul>
<li>注意短路现象。</li>
</ul>
<h2 id="4-4-赋值运算符"><a href="#4-4-赋值运算符" class="headerlink" title="4.4 赋值运算符"></a>4.4 赋值运算符</h2><ul>
<li>C++11允许使用花括号括起来的初始值列表作为赋值语句右侧运算对象。对内置类型，初始值列表最多只能包含一个值，且即使类型转化所占空间也不能大于目标类型的空间。对类类型，赋值运算细节由类本身决定。</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">int k;</span><br><span class="line">k = &#123;3.14&#125;  // 错误，窄化转换</span><br><span class="line">vector&lt;int&gt; vi;</span><br><span class="line">vi = &#123;1, 2, 3&#125;;</span><br></pre></td></tr></table></figure>
<ul>
<li>复合赋值运算符。</li>
</ul>
<h2 id="4-5-递增和递减运算符"><a href="#4-5-递增和递减运算符" class="headerlink" title="4.5 递增和递减运算符"></a>4.5 递增和递减运算符</h2><ul>
<li>除非必须，否则不用后置版本，因为会带来消耗，尤其是复制的迭代器。</li>
<li>后置常用在<code>*p++</code>上，让代码更简洁。</li>
<li>避免在表达式其它地方用到递增或递减的变量。</li>
</ul>
<h2 id="4-6-成员访问运算符"><a href="#4-6-成员访问运算符" class="headerlink" title="4.6 成员访问运算符"></a>4.6 成员访问运算符</h2><ul>
<li>注意解引用运算符优先级低于点运算符，所以<code>(*p).size()</code>中括号不可省略。</li>
</ul>
<h2 id="4-7-条件运算符"><a href="#4-7-条件运算符" class="headerlink" title="4.7 条件运算符"></a>4.7 条件运算符</h2><ul>
<li>条件运算符优先级非常低，记得使用括号。</li>
<li>可以嵌套使用，但会降低可读性。</li>
</ul>
<h2 id="4-8-位运算符"><a href="#4-8-位运算符" class="headerlink" title="4.8 位运算符"></a>4.8 位运算符</h2><p><img src="http://static.ifanze.cn/2018-06-23-14919840621288.jpg" alt=""></p>
<ul>
<li>用于整数类型，把对象看作二进制位的集合。标准库类型<code>bitset</code>可以表示任意大小的二进制位集合，也可以使用。</li>
<li>一般小整型会被自动提升为较大整型，运算对象可以有符号，但对负数的运算依赖于机器，并且左移还可能改变符号位，所以推荐操作无符号数。</li>
</ul>
<h2 id="4-9-sizeof运算符"><a href="#4-9-sizeof运算符" class="headerlink" title="4.9 sizeof运算符"></a>4.9 sizeof运算符</h2><p>返回表达式或类型名所占的字节数，结果是<code>size_t</code>类型的常量表达式。有两种形式：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">sizeof</span>(type)</span><br><span class="line"><span class="keyword">sizeof</span> expr     <span class="comment">// 返回表达式结果类型的大小，并不计算运算对象的值。</span></span><br></pre></td></tr></table></figure>
<ul>
<li>因为不计算，<code>sizeof *p</code>中，即便p是个无效的指针也没有问题。</li>
<li>C++11中允许使用作用域运算符获得类成员的大小，如<code>sizeof Sales_data::revenue</code>。</li>
<li>sizeof不会吧把数组转化成指针进行处理，得到的是数组所占字节数。</li>
<li>对容器使用只返回该类型固定部分的大小。</li>
</ul>
<h2 id="4-10-逗号表达式"><a href="#4-10-逗号表达式" class="headerlink" title="4.10 逗号表达式"></a>4.10 逗号表达式</h2><ul>
<li>左右先后执行，返回右侧的表达式结果。</li>
<li>常用在for循环。</li>
</ul>
<h2 id="4-11-类型转换"><a href="#4-11-类型转换" class="headerlink" title="4.11 类型转换"></a>4.11 类型转换</h2><ul>
<li>如果两种类型可以相互转换，那么它们就是关联的。</li>
<li>隐式转换。</li>
</ul>
<h3 id="4-11-1-算术转换"><a href="#4-11-1-算术转换" class="headerlink" title="4.11.1 算术转换"></a>4.11.1 算术转换</h3><h3 id="4-11-2-其它隐式类型转换"><a href="#4-11-2-其它隐式类型转换" class="headerlink" title="4.11.2 其它隐式类型转换"></a>4.11.2 其它隐式类型转换</h3><h3 id="4-11-3-显式转换"><a href="#4-11-3-显式转换" class="headerlink" title="4.11.3 显式转换"></a>4.11.3 显式转换</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cast-name&lt;type&gt; (expression);</span><br></pre></td></tr></table></figure>
<p>cast-name：</p>
<ul>
<li><code>dynamic_cast</code>：支持运行时类型识别。<em>19.2</em></li>
<li><code>static_cast</code>：任何具有明确定义的类型转换，只要不包含底层const。</li>
<li><code>const_cast</code>：只能改变运算对象的底层const。去掉其const性质，让编译器不再阻止我们进行写操作。但如果对象是常量，写操作会造成未定义的结果。常用在函数重载中。<em>6.4</em></li>
</ul>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="keyword">char</span> *pc;</span><br><span class="line"><span class="keyword">char</span> *p = <span class="keyword">const_cast</span>&lt;<span class="keyword">char</span>*&gt;(pc);</span><br></pre></td></tr></table></figure>
<ul>
<li><code>reinterpret_cast</code>：从位的模式提供较低层次的重新解释。风险较大。</li>
</ul>
<p>旧式转换：</p>
<figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">type (expr);</span><br><span class="line">(type) expr;</span><br></pre></td></tr></table></figure>
<h2 id="4-12-运算符优先级表"><a href="#4-12-运算符优先级表" class="headerlink" title="4.12 运算符优先级表"></a>4.12 运算符优先级表</h2><p><img src="http://static.ifanze.cn/2018-06-23-14919859071475.jpg" alt=""><br><img src="http://static.ifanze.cn/2018-06-23-14919859310420.jpg" alt=""></p>
</div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者：</strong>Meng Fanze</li><li class="post-copyright-link"><strong>本文链接：</strong><a href="/2017/07/24/《C++ Primer》读书笔记 (4)/">http://ifanze.cn/2017/07/24/《C++ Primer》读书笔记 (4)/</a></li><li class="post-copyright-license"><strong>版权声明：</strong>转载请在评论区说明。</li></ul></div><br><div class="tags"><a href="/tags/C/">C++</a><a href="/tags/读书/">读书</a></div><div class="post-nav"><a class="pre" href="/2017/11/26/《C++ Primer》读书笔记 (5)/">《C++ Primer》读书笔记 5</a><a class="next" href="/2017/04/11/《C++ Primer》读书笔记 (3)/">《C++ Primer》读书笔记 3</a></div><div id="vcomment"></div><script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="//unpkg.com/valine@latest/dist/Valine.min.js"></script><script>var notify = 'true' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'kfIuT7r4gG6hnmNl3uQ5vOqp-gzGzoHsz',
  appKey:'59tx3uBM3K1Ao4JFH5oE3VEK',
  placeholder:'Welcome~',
  avatar:'retro',
  guest_info:guest_info,
  pageSize:'10'
})</script></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"/><input type="hidden" name="sitesearch" value="http://ifanze.cn"/></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/《C-Primer》/">《C++ Primer》</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/笔记/">笔记</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/libevent/" style="font-size: 15px;">libevent</a> <a href="/tags/docker/" style="font-size: 15px;">docker</a> <a href="/tags/git/" style="font-size: 15px;">git</a> <a href="/tags/homebrew/" style="font-size: 15px;">homebrew</a> <a href="/tags/nodejs/" style="font-size: 15px;">nodejs</a> <a href="/tags/blog/" style="font-size: 15px;">blog</a> <a href="/tags/C/" style="font-size: 15px;">C++</a> <a href="/tags/macOS/" style="font-size: 15px;">macOS</a> <a href="/tags/network/" style="font-size: 15px;">network</a> <a href="/tags/读书/" style="font-size: 15px;">读书</a> <a href="/tags/python/" style="font-size: 15px;">python</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-external-link"> 友情链接</i></div><ul></ul><a href="http://ifanze.cn" title="欢迎友链～" target="_blank">欢迎友链～</a></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">Meng Fanze's Blog.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//cdn.bootcss.com/fancybox/3.3.5/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>